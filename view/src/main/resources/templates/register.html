
<!DOCTYPE html>
<html>
<head>
		<meta charset="utf-8">
		<link href="/css/login.css" rel='stylesheet' type='text/css' />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- JS: load the page without delay -->
		<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } 
		</script>
		<script src="/js/axios.min.js"></script>
		<script src="/js/api.js"></script>
</head>
 
<body>
	<div class="register">	
				 <!-- start-main -->
				<!-- 返回按钮 -->
				<div class="back-button-container">
					<a href="/" class="back-button">back</a>
				</div>
				 <form id="checkRegister" action="" method="post">
		                    <div class="clear"> </div>
		                    <div class="lable-2">
							<h3 style="padding-bottom: 0px;">email:</h3>
								<input type="text" class="text" id="email" placeholder="your@email.com ">
							<h3 style="padding-bottom: 0px;">Email verification code:</h3>
								<input type="text" class="text" id="verification code" placeholder="Verification code" style="width:60%;"/><div class="vcodeNumber" style=" height:40px;cursor: pointer;background: none;float: left;padding: 14px;"></div>
							<div class="submitverificationcode" style="height: 40px; cursor: pointer; background: none; float: right;padding: 14px;width: 25%;">
								<input type="submit" id="submitverification" value="Send" style="font-size: 10px;">
							</div>
							<h3 style="padding-bottom: 0px;">username:</h3>
								<input type="text" class="text" id="username" placeholder="username">
							<h3 style="padding-bottom: 0px;">Password:</h3>
								<input type="password" class="text" id="password" placeholder="Password">
							<h3 style="padding-bottom: 0px;">Birth Date:</h3>
								<input required="" placeholder="Enter birth date" type="date" class="text" id="birth" aria-placeholder="brith">
							</div>
					 		<h3 style="padding-bottom: 0px;">Gender:</h3>
					 			<div class="radio-input">
						 			<div class="radio-b">
							 			<input type="radio" class="radio-b__input" id="male" name="gender" value="true" />
										<label class="radio-b__label" for="male">
								 			<div class="radio-b__custom">
									 			<span class="radio-b__custom-fill"></span>
								 			</div>
											<span class="radio-b__text">Man</span>
							 			</label>
						 			</div>
						 			<div class="radio-b">
										<input type="radio" class="radio-b__input" id="female" name="gender" value="false" />
							 			<label class="radio-b__label" for="female">
								 			<div class="radio-b__custom">
									 			<span class="radio-b__custom-fill"></span>
								 			</div>
								 			<span class="radio-b__text">Woman</span>
							 			</label>
						 			</div>
					 			</div>
					 <div class="clear"> </div>
							<div class="submit" style="margin-left: 0.3%; margin-right: -10px; padding-top: -20px;">
								<input type="submit" id="submit" value="Create account">
							</div>
							<div class="clear"> </div>
							<h3 style="margin-top: -10px; ">Already have an account? <span><a href="/login" style="color:#F2CA68;">Log in </a> <span></h3>
							<h3>By creating an account, you agree to our <b>Terms & Conditions:</b></h3>
							<div class="term-condition" style="margin-left:4%; margin-right:-1%; text-align: left;margin-bottom: 20px;">You need to follow these terms:</br>
							Welcome and thanks for using How To Chooose. When you use our services, you are entering into a legal agreement and you agree to all of these terms, so please take a few minutes to read over the following User Agreement.</br>
							1.	Our purpose</br>
							Our mission is to provide a web platform based on data collection system and online communication system for publics, which help people (especially for those terribly indecisive) make choice in a complicated situation or in an area which they are interested in. As well as to collect publics’ opinions for some hot topics through public voting.</br>
							2.	Agreement about Privacy Policy</br>
							You agree to our Privacy Policy, which covers how we collect, use, share, and store your personal information.</br>
							3.	Your Membership</br>
							You’ll keep your password a secret and do not share an account with anyone else. You also must promise that you will follow the rules, the law and all relative regulations.</br>
							You agree to:</br>
							1)	Try to choose a strong and secure password;</br>
							2)	Keep your password secure and confidential;</br>
							3)	Not transfer any part of your account(e.g., personal information)</br>
							4)	You are responsible for anything that happens through your account unless you close it or report misuse.</br>
							4.	Electronic communications</br>
							When you use any How To Chooose service, send e-mail or other communications from your desktop or mobile device to us, you are communicating with us electronically. When you receive communications from us electronically, such as e-mail or notice and messages on this site, you can retain copies of these communications for your records. You agree that all agreements, notices, disclosures, and other communications that we provide to you electronically satisfy any legal requirement that such communications be in writing.</br>
							5.	Reviews, comments, communications and other content</br>
							Visitors may post reviews, comments, photos, and other content; and submit suggestions, ideas, comments, questions, or other information, so long as the content is not illegal, obscene, threatening, defamatory, invasive of privacy, infringing of intellectual property rights (including publicity rights), or otherwise injurious to third parties or objectionable, and does not consist of or contain software viruses, political campaigning, commercial solicitation, chain letters, mass mailings, or any form of "spam" or unsolicited commercial electronic messages. You may not use a false e-mail address, impersonate any person or entity. How To Chooose reserves the right (but not the obligation) to remove or edit such content.</br>
							6.	Applicable law</br>
							By using any How To Chooose Service, you agree to observe the law and regulations of People’s Republic of China, and use these law and regulations to govern any dispute of any sort that might arise between you and How To Chooose.
							</div>
					</form>
		<!-- end-main -->
		</div>
		 <!-- start-copyright -->
   					<div class="copy-right" style="margin-bottom: 40px; overflow: hidden; float:left; margin:0 30%;">
						<p>Copyright @ 2024 Online Polling System. All Rights Reserved.</p>
					</div>
				<!-- end-copyrigh -->
	<script type="module">
		//发送邮箱验证码
		async function sendVerificationCode(event) {
			event.preventDefault(); // 阻止表单的默认提交行为

			try {
				// 从表单中获取用户输入的邮箱
				const email = document.getElementById('email').value;

				instance.post('/user/register/step/1', {
					email: email
				})
						.then(response => {
							if (response.data.code == 0) {
								alert("Verification code sent successfully!");
							}else {
								alert('Failed to send verification code: ' + response.data.msg);
							}
						})

			} catch (error) {
				// 处理网络错误或其他客户端错误
				console.error('Network Error:', error.message);
				alert('A network error occurred. Please check your connection and try again.');
			}
		}

		//注册用户
		async function registerUser(event) {
			event.preventDefault(); // 阻止表单的默认提交行为

			try {
				// 从表单中获取用户输入的所有信息
				const email = document.getElementById('email').value;
				const verification = document.getElementById('verification code').value;
				const username = document.getElementById('username').value;
				const password = document.getElementById('password').value;
				const birth = document.getElementById('birth').value;
				const genderInput = document.querySelector('input[name="gender"]:checked');
				const gender = genderInput.value === 'true';

				instance.post(`/user/register/step/2?verification=${encodeURIComponent(verification)}`, {
					email: email,
					username: username,
					password: password,
					birth: birth,
					gender: gender
				})
						.then(response => {
							if (response.data.code == 0) {
								alert("Registered successfully!");
								// 注册成功后，可以重定向到主页或其他页面
								window.location.href = '/'; // 替换为实际的重定向URL
							}else {
								alert('Registration failure: ' + response.data.msg);
							}
						})

			}catch (error) {
				// 处理网络错误或其他客户端错误
				console.error('Network Error:', error.message);
				alert('A network error occurred. Please check your connection and try again.');
				}
			}
		}

		// 为 "Send verification code" 按钮添加点击事件监听器
		document.getElementById('submitverification').addEventListener('click', sendVerificationCode);

		// 为 "Create account" 按钮添加点击事件监听器
		document.getElementById('submit').addEventListener('click', registerUser);


		// 为每个 radio 按钮添加点击事件监听器
		document.querySelectorAll('.radio-b__input').forEach(radio => {
			radio.addEventListener('change', function(event) {
				if (this.checked) {
					// 获取当前选中的 radio 按钮的 id
					const selectedId = this.id;
					console.log('Selected radio button ID:', selectedId);
				}
			});
		});
	</script>
	 
</body>
</html>